# Интеграция AI-агента TW.Cloud в Telegram-бота

Готовое Dockerfile-приложение для простого запуска Telegram-бота, работающего на основе AI-агента Timeweb.Cloud. Для начала работы достаточно указать необходимые переменные окружения и выполнить деплой.

## Конфигурация

Перед запуском следует создать эти переменные окружения:

*   `TELEGRAM_TOKEN` **(обязательно)** — Токен вашего Telegram-бота, полученный от [@BotFather](https://t.me/BotFather).
*   `AGENT_ID` **(обязательно)** — ID вашего AI-агента. Можно скопировать во вкладке "Доступ" в панели управления Timeweb.Cloud.
*   `AI_TOKEN` **(обязательно)** — API-ключ агента. Создается во вкладке "Доступ" при выборе "Тип API".
*   `HI_MSG` *(опционально)* — Приветственное сообщение, которое бот отправляет по команде `/start`. По умолчанию: `Добро пожаловать!`. Для создания отступа используйте символы `\n`. Содержимое переменной указывается в двойных кавычках (`"`), если используются переносы или пробелы.
*   `ERR_MSG` *(опционально)* - Сообщение, которое бот отправит при ошибке. По умолчанию: `Извините, сейчас не могу ответить. Попробуйте позже.`. Для создания отступа используйте символы `\n`. Содержимое переменной указывается в двойных кавычках (`"`), если используются переносы или пробелы.

## Особенности реализации

*   **Только текстовое взаимодействие:** Бот работает в режиме запрос-ответ, запоминая контекст диалога.
*   **Нативный API:** Для общения с AI-агентом используется Нативное API Timeweb.Cloud.
*   **Поддержка Markdown:** Если агент использует Markdown, то сообщения от агента форматируются по правилам Telegram для лучшей читаемости.
*   **Полная интеграция с TW.Cloud:** Корректно обрабатывает системный промпт, заданный в панели управления, а также использует прикреплённую Базу Знаний (RAG).
*   **Обработка длинных сообщений:** Если ответ агента длиннее 4096 символов, он будет отправлен несколькими сообщениями.

## Быстрый старт

1.  Соберите и настройте вашего агента в [панели управления Timeweb.Cloud](https://timeweb.cloud/my/cloud-ai/agents).
2.  Создайте бота в Telegram через [@BotFather](https://t.me/BotFather) и скопируйте его токен.
3.  Разверните Dockerfile-приложение в Timeweb.Cloud, указав ссылку на этот репозиторий и все необходимые переменные. При деплое рекомендую выбрать самый последний коммит. 
4.  Готово. Бот активен и готов к общению.
